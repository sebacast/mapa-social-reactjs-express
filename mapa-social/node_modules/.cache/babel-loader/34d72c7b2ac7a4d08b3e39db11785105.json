{"ast":null,"code":"var _jsxFileName = \"/Users/sebastian/Desktop/mapa-social-sin-claves/mapa-social/src/componentes/Acceso.js\";\nimport React, { Component } from 'react';\nimport Principal from './Principal';\nimport Login from './Login';\nimport { getToken, apiPath } from './funciones';\n\nclass Acceso extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      acceso: false\n    };\n    this.controlPorApi = this.controlPorApi.bind(this);\n  }\n\n  componentDidMount() {\n    this.controlAcceso();\n    this.interval = setInterval(() => {\n      this.controlAcceso();\n    }, 30000);\n  }\n\n  componentWillUnmount() {\n    clearInterval(this.interval);\n  }\n\n  controlAcceso() {\n    if (JSON.parse(localStorage.getItem('acc'))) {\n      this.controlPorApi();\n    }\n  }\n\n  controlPorApi() {\n    let url = apiPath() + '/users';\n    fetch(url, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': getToken()\n      }\n    }).then(res => res.json()).then((data, error) => {\n      this.setAcceso(data, error);\n    }); //.catch(() => this.negarAcceso());\n  }\n\n  negarAcceso() {\n    localStorage.clear();\n    window.location.reload();\n  }\n\n  setAcceso(data, error) {\n    if (error || typeof data.conectado === 'undefined' || data.conectado === false) {\n      this.negarAcceso();\n    }\n  }\n\n  autorizacion() {\n    try {\n      let valido = JSON.parse(localStorage.getItem('acc')).valido;\n\n      if (valido === true) {\n        return React.createElement(Principal, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 53\n          },\n          __self: this\n        });\n      } else {\n        return React.createElement(Login, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 56\n          },\n          __self: this\n        });\n      }\n    } catch (err) {\n      return React.createElement(Login, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 61\n        },\n        __self: this\n      });\n    }\n  }\n\n  render() {\n    return this.autorizacion();\n  }\n\n}\n\nexport default Acceso;","map":{"version":3,"sources":["/Users/sebastian/Desktop/mapa-social-sin-claves/mapa-social/src/componentes/Acceso.js"],"names":["React","Component","Principal","Login","getToken","apiPath","Acceso","constructor","props","state","acceso","controlPorApi","bind","componentDidMount","controlAcceso","interval","setInterval","componentWillUnmount","clearInterval","JSON","parse","localStorage","getItem","url","fetch","method","headers","then","res","json","data","error","setAcceso","negarAcceso","clear","window","location","reload","conectado","autorizacion","valido","err","render"],"mappings":";AAAA,OAAOA,KAAP,IAAgBC,SAAhB,QAAiC,OAAjC;AACA,OAAOC,SAAP,MAAsB,aAAtB;AACA,OAAOC,KAAP,MAAkB,SAAlB;AACA,SAASC,QAAT,EAAmBC,OAAnB,QAAkC,aAAlC;;AACA,MAAMC,MAAN,SAAqBL,SAArB,CAA+B;AAC9BM,EAAAA,WAAW,CAACC,KAAD,EAAQ;AAClB,UAAMA,KAAN;AACA,SAAKC,KAAL,GAAa;AACZC,MAAAA,MAAM,EAAE;AADI,KAAb;AAGA,SAAKC,aAAL,GAAqB,KAAKA,aAAL,CAAmBC,IAAnB,CAAwB,IAAxB,CAArB;AACA;;AACDC,EAAAA,iBAAiB,GAAE;AAClB,SAAKC,aAAL;AACA,SAAKC,QAAL,GAAgBC,WAAW,CAAC,MAAM;AACjC,WAAKF,aAAL;AACE,KAFwB,EAEtB,KAFsB,CAA3B;AAGA;;AACDG,EAAAA,oBAAoB,GAAG;AACtBC,IAAAA,aAAa,CAAC,KAAKH,QAAN,CAAb;AACE;;AACHD,EAAAA,aAAa,GAAE;AACd,QAAGK,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,KAArB,CAAX,CAAH,EAA2C;AACzC,WAAKX,aAAL;AACA;AACF;;AACDA,EAAAA,aAAa,GAAG;AACf,QAAIY,GAAG,GAAGlB,OAAO,KAAK,QAAtB;AACAmB,IAAAA,KAAK,CAACD,GAAD,EAAM;AACVE,MAAAA,MAAM,EAAE,KADE;AAEVC,MAAAA,OAAO,EAAE;AACR,wBAAgB,kBADR;AAER,yBAAiBtB,QAAQ;AAFjB;AAFC,KAAN,CAAL,CAOEuB,IAPF,CAOOC,GAAG,IAAIA,GAAG,CAACC,IAAJ,EAPd,EAQEF,IARF,CAQO,CAACG,IAAD,EAAMC,KAAN,KAAgB;AAAC,WAAKC,SAAL,CAAeF,IAAf,EAAoBC,KAApB;AAA2B,KARnD,EAFe,CAWd;AACD;;AACDE,EAAAA,WAAW,GAAE;AACZZ,IAAAA,YAAY,CAACa,KAAb;AACMC,IAAAA,MAAM,CAACC,QAAP,CAAgBC,MAAhB;AACN;;AACDL,EAAAA,SAAS,CAACF,IAAD,EAAMC,KAAN,EAAY;AACpB,QAAGA,KAAK,IAAI,OAAOD,IAAI,CAACQ,SAAZ,KAA0B,WAAnC,IAAkDR,IAAI,CAACQ,SAAL,KAAmB,KAAxE,EAA8E;AAC7E,WAAKL,WAAL;AACA;AACD;;AACDM,EAAAA,YAAY,GAAG;AACd,QAAG;AACF,UAAIC,MAAM,GAAGrB,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,KAArB,CAAX,EAAwCkB,MAArD;;AACA,UAAGA,MAAM,KAAK,IAAd,EAAmB;AAClB,eAAO,oBAAC,SAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAAP;AACA,OAFD,MAGI;AACH,eAAO,oBAAC,KAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,UAAP;AACA;AAED,KATD,CAUA,OAAMC,GAAN,EAAU;AACT,aAAO,oBAAC,KAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAAP;AACA;AACD;;AACDC,EAAAA,MAAM,GAAG;AACR,WAAO,KAAKH,YAAL,EAAP;AACA;;AA7D6B;;AA+D/B,eAAejC,MAAf","sourcesContent":["import React, { Component } from 'react';\nimport Principal from './Principal';\nimport Login from './Login';\nimport { getToken, apiPath } from './funciones';\nclass Acceso extends Component {\n\tconstructor(props) {\n\t\tsuper(props)\n\t\tthis.state = {\n\t\t\tacceso: false,\n\t\t};\n\t\tthis.controlPorApi = this.controlPorApi.bind(this);\n\t}\n\tcomponentDidMount(){\n\t\tthis.controlAcceso();\n\t\tthis.interval = setInterval(() => {\n\t\t\tthis.controlAcceso();\n\t\t  }, 30000);\n\t}\n\tcomponentWillUnmount() {\n\t\tclearInterval(this.interval);\n\t  }\n\tcontrolAcceso(){\n\t\tif(JSON.parse(localStorage.getItem('acc'))){\n\t\t\t\tthis.controlPorApi()\n\t\t\t}\n\t}\n\tcontrolPorApi() {\n\t\tlet url = apiPath() + '/users';\n\t\tfetch(url, {\n\t\t\tmethod: 'GET',\n\t\t\theaders: {\n\t\t\t\t'Content-Type': 'application/json',\n\t\t\t\t'Authorization': getToken(),\n\t\t\t}\n\t\t})\n\t\t\t.then(res => res.json())\n\t\t\t.then((data,error) => {this.setAcceso(data,error)});\n\t\t\t//.catch(() => this.negarAcceso());\n\t}\n\tnegarAcceso(){\n\t\tlocalStorage.clear();\n        window.location.reload();\n\t}\n\tsetAcceso(data,error){\n\t\tif(error || typeof data.conectado === 'undefined' || data.conectado === false){\n\t\t\tthis.negarAcceso();\n\t\t}\n\t}\n\tautorizacion() {\n\t\ttry{\n\t\t\tlet valido = JSON.parse(localStorage.getItem('acc')).valido\n\t\t\tif(valido === true){\n\t\t\t\treturn <Principal/>\n\t\t\t}\n\t\t\telse{\n\t\t\t\treturn <Login />\n\t\t\t}\n\t\t\t\n\t\t}\n\t\tcatch(err){\n\t\t\treturn <Login />\n\t\t}\n\t}\n\trender() {\n\t\treturn this.autorizacion()\n\t}\n}\nexport default Acceso;\n"]},"metadata":{},"sourceType":"module"}