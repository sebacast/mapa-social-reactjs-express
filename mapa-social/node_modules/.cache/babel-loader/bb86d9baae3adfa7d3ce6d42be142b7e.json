{"ast":null,"code":"var _jsxFileName = \"/Users/sebastian/Desktop/mapa-social-sin-claves/mapa-social/src/componentes/NotiContactos.js\";\nimport React, { Component } from 'react';\nimport { getToken, apiPath } from './funciones';\n\nclass NotiContactos extends Component {\n  constructor() {\n    super();\n    this.state = {\n      solicitudes: [],\n      redibujo: false\n    };\n    this.getSolicitudesContactos = this.getSolicitudesContactos.bind(this);\n    this.responderSolicitud = this.responderSolicitud.bind(this);\n  }\n\n  componentDidMount() {\n    this.getSolicitudesContactos();\n  }\n\n  renderContSolicitudes() {\n    let solicitudes = this.state.solicitudes;\n\n    if (solicitudes.length > 0) {\n      return solicitudes.length;\n    } else {\n      return 0;\n    }\n  }\n\n  getSolicitudesContactos() {\n    let url = apiPath() + '/contactos/solicitudes';\n    fetch(url, {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n        'Authorization': getToken()\n      }\n    }).then(response => response.json()).then(data => this.comprobarGetSol(data));\n  }\n\n  comprobarGetSol(data) {\n    if (data !== null && data.valido !== false) {\n      this.setState({\n        solicitudes: data\n      });\n    }\n  }\n\n  renderNotificaciones() {\n    let solicitudes = this.state.solicitudes;\n\n    if (solicitudes !== null && solicitudes.length > 0) {\n      return React.createElement(\"ul\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 46\n        },\n        __self: this\n      }, this.recorrerNoti(solicitudes));\n    }\n  }\n\n  recorrerNoti(solicitudes) {\n    return solicitudes.map(c => {\n      return React.createElement(\"li\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 54\n        },\n        __self: this\n      }, React.createElement(\"a\", {\n        href: true,\n        class: \"clearfix\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 55\n        },\n        __self: this\n      }, React.createElement(\"img\", {\n        src: c.imagen,\n        alt: c.nombre,\n        className: \"img-circle\",\n        style: {\n          width: '10%',\n          margin: '1%'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 57\n        },\n        __self: this\n      }), React.createElement(\"i\", {\n        class: \"fa fa-check\",\n        style: {\n          'color': 'green'\n        },\n        \"data-e\": c._id,\n        \"data-r\": true,\n        onClick: this.responderSolicitud.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 58\n        },\n        __self: this\n      }, \"Aceptar\"), \"  \", React.createElement(\"i\", {\n        class: \"fa fa-times\",\n        style: {\n          'color': 'red'\n        },\n        \"data-e\": c._id,\n        \"data-r\": false,\n        onClick: this.responderSolicitud.bind(this),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 58\n        },\n        __self: this\n      }, \"Rechazar\"), React.createElement(\"span\", {\n        class: \"title\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 59\n        },\n        __self: this\n      }, c.nombre, \" te envi\\xF3 una solicitud de contacto\"), React.createElement(\"span\", {\n        class: \"message\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 60\n        },\n        __self: this\n      }, c._id)), React.createElement(\"hr\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 62\n        },\n        __self: this\n      }));\n    });\n  }\n\n  responderSolicitud(event) {\n    try {\n      let email = event.target.getAttribute('data-e');\n      let respuesta = event.target.getAttribute('data-r');\n      let url;\n      let metodo;\n\n      if (respuesta === 'false') {\n        metodo = 'POST';\n        url = apiPath() + '/contactos/solicitud/rechazar';\n        this.resSol(url, metodo, email);\n        this.setState({\n          redibujo: !this.state.redibujo\n        });\n      } else if (respuesta === 'true') {\n        url = apiPath() + '/contactos';\n        metodo = 'PUT';\n        this.resSol(url, metodo, email);\n        metodo = 'POST';\n        url = apiPath() + '/contactos/solicitud/rechazar';\n        this.resSol(url, metodo, email);\n      } else {\n        return null;\n      }\n    } catch (error) {\n      alert('error');\n    }\n  }\n\n  resSol(url, metodo, email) {\n    fetch(url, {\n      method: metodo,\n      headers: {\n        'Content-Type': 'application/x-www-form-urlencoded',\n        'Authorization': getToken()\n      },\n      body: JSON.stringify({\n        emisor: email\n      })\n    }).then(res => res.json()).then(data => this.comprobarResSol(data)).then(() => window.location.reload());\n  }\n\n  comprobarResSol(data) {\n    if (data === null || data.valido === false) {\n      alert(\"Error\");\n    }\n  }\n\n  render() {\n    return React.createElement(\"ul\", {\n      class: \"notifications\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 118\n      },\n      __self: this\n    }, React.createElement(\"li\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 119\n      },\n      __self: this\n    }, React.createElement(\"a\", {\n      href: true,\n      class: \"dropdown-toggle notification-icon\",\n      \"data-toggle\": \"dropdown\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 120\n      },\n      __self: this\n    }, React.createElement(\"i\", {\n      class: \"fa fa-users\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 121\n      },\n      __self: this\n    }), React.createElement(\"span\", {\n      class: \"badge\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 122\n      },\n      __self: this\n    }, \" \", this.renderContSolicitudes())), React.createElement(\"div\", {\n      class: \"dropdown-menu notification-menu\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      class: \"notification-title\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125\n      },\n      __self: this\n    }, React.createElement(\"span\", {\n      class: \"pull-right label label-default\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126\n      },\n      __self: this\n    }, this.renderContSolicitudes()), \"Solicitudes\"), React.createElement(\"div\", {\n      class: \"content\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 129\n      },\n      __self: this\n    }, this.renderNotificaciones()))));\n  }\n\n}\n\nexport default NotiContactos;","map":{"version":3,"sources":["/Users/sebastian/Desktop/mapa-social-sin-claves/mapa-social/src/componentes/NotiContactos.js"],"names":["React","Component","getToken","apiPath","NotiContactos","constructor","state","solicitudes","redibujo","getSolicitudesContactos","bind","responderSolicitud","componentDidMount","renderContSolicitudes","length","url","fetch","method","headers","then","response","json","data","comprobarGetSol","valido","setState","renderNotificaciones","recorrerNoti","map","c","imagen","nombre","width","margin","_id","event","email","target","getAttribute","respuesta","metodo","resSol","error","alert","body","JSON","stringify","emisor","res","comprobarResSol","window","location","reload","render"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport { getToken, apiPath } from './funciones';\nclass NotiContactos extends Component {\n    constructor() {\n        super();\n        this.state = {\n            solicitudes: [],\n            redibujo: false,\n        };\n        this.getSolicitudesContactos = this.getSolicitudesContactos.bind(this);\n        this.responderSolicitud = this.responderSolicitud.bind(this)\n    }\n    componentDidMount() {\n\n        this.getSolicitudesContactos();\n    }\n    renderContSolicitudes() {\n        let solicitudes = this.state.solicitudes;\n        if (solicitudes.length > 0) {\n            return solicitudes.length\n        }\n        else {\n            return 0\n        }\n    }\n    getSolicitudesContactos() {\n        let url = apiPath() + '/contactos/solicitudes';\n        fetch(url, {\n            method: 'GET',\n            headers: {\n                'Content-Type': 'application/json',\n                'Authorization': getToken()\n            },\n        })\n            .then(response => response.json())\n            .then(data => this.comprobarGetSol(data));\n    }\n    comprobarGetSol(data) {\n        if (data !== null && data.valido !== false) {\n            this.setState({ solicitudes: data })\n        }\n    }\n    renderNotificaciones() {\n        let solicitudes = this.state.solicitudes;\n        if (solicitudes !== null && solicitudes.length > 0) {\n            return <ul>\n                {this.recorrerNoti(solicitudes)}\n            </ul>\n        }\n    }\n    recorrerNoti(solicitudes) {\n        return (solicitudes.map(c => {\n            return (\n                <li >\n                    <a href class=\"clearfix\"  >\n\n                        <img src={c.imagen} alt={c.nombre} className=\"img-circle\" style={{ width: '10%', margin: '1%' }} />\n                        <i class=\"fa fa-check\" style={{ 'color': 'green' }} data-e={c._id} data-r={true} onClick={this.responderSolicitud.bind(this)} >Aceptar</i>  <i class=\"fa fa-times\" style={{ 'color': 'red' }} data-e={c._id} data-r={false} onClick={this.responderSolicitud.bind(this)} >Rechazar</i>\n                        <span class=\"title\" >{c.nombre} te envió una solicitud de contacto</span>\n                        <span class=\"message\" >{c._id}</span>\n                    </a>\n                    <hr />\n                </li>)\n        }))\n    }\n    responderSolicitud(event) {\n        try {\n            let email = event.target.getAttribute('data-e');\n            let respuesta = event.target.getAttribute('data-r');\n            let url;\n            let metodo;\n            if (respuesta === 'false') {\n                metodo = 'POST';\n                url = apiPath() + '/contactos/solicitud/rechazar';\n                this.resSol(url, metodo, email);\n                this.setState({ redibujo: !this.state.redibujo })\n            }\n            else if (respuesta === 'true') {\n\n                url = apiPath() + '/contactos';\n                metodo = 'PUT'\n                this.resSol(url, metodo, email);\n                metodo = 'POST';\n                url = apiPath() + '/contactos/solicitud/rechazar';\n                this.resSol(url, metodo, email);\n\n\n            }\n            else {\n                return null;\n            }\n        } catch (error) {\n            alert('error')\n        }\n    }\n    resSol(url, metodo, email) {\n        fetch(url, {\n            method: metodo,\n            headers: {\n                'Content-Type': 'application/x-www-form-urlencoded',\n                'Authorization': getToken(),\n            },\n            body: JSON.stringify({ emisor: email })\n\n        })\n            .then(res => res.json())\n            .then(data => this.comprobarResSol(data))\n            .then(() => window.location.reload())\n    }\n    comprobarResSol(data) {\n        if (data === null || data.valido === false) {\n            alert(\"Error\")\n        }\n    }\n\n    render() {\n        return (\n            <ul class=\"notifications\"  >\n                <li>\n                    <a href class=\"dropdown-toggle notification-icon\" data-toggle=\"dropdown\">\n                        <i class=\"fa fa-users\"></i>\n                        <span class=\"badge\"> {this.renderContSolicitudes()}</span>\n                    </a>\n                    <div class=\"dropdown-menu notification-menu\">\n                        <div class=\"notification-title\">\n                            <span class=\"pull-right label label-default\">{this.renderContSolicitudes()}</span>\n                            Solicitudes\n\t\t\t\t\t\t\t\t</div>\n                        <div class=\"content\">\n                            {this.renderNotificaciones()}\n                        </div>\n                    </div>\n                </li>\n\n            </ul>\n        );\n    }\n}\nexport default NotiContactos;\n"]},"metadata":{},"sourceType":"module"}